<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OLS Viikkopelit - Data Check</title>
    <link rel="stylesheet" href="/css/style.css">
    <style>
        /* Additional styles for tables */
        .game-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1.5rem;
        }
        .game-table th, .game-table td {
            border: 1px solid #e2e8f0;
            padding: 0.5rem;
        }
        .game-table th {
            background-color: #f8fafc;
            font-weight: 600;
        }
        .game-table tr:nth-child(even) {
            background-color: #f1f5f9;
        }
        .empty-team {
            color: #dc2626;
            font-style: italic;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 p-4">
    <div class="max-w-6xl mx-auto">
        <header class="bg-white p-6 rounded-lg shadow-md mb-6">
            <div class="flex justify-between items-center">
                <h1 class="text-2xl font-bold">OLS Viikkopelit - Data Check</h1>
                <a href="/" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition duration-150 ease-in-out">
                    Back to Dashboard
                </a>
            </div>
            <div class="mt-4">
                <p class="text-gray-600">
                    Schedule Date: <span class="font-semibold"><%= documentDate %></span>
                </p>
                <p class="text-gray-600">
                    Total Games: <span class="font-semibold"><%= totalGames %></span> | 
                    Total Fields: <span class="font-semibold"><%= totalFields %></span>
                </p>
            </div>
            
            <% if (issues && issues.length > 0) { %>
                <div class="mt-4 p-4 bg-yellow-100 border border-yellow-400 text-yellow-700 rounded-md">
                    <h3 class="font-semibold mb-2">Potential Data Issues:</h3>
                    <ul class="list-disc pl-5">
                        <% issues.forEach(issue => { %>
                            <li><%= issue %></li>
                        <% }); %>
                    </ul>
                </div>
            <% } %>
        </header>
        
        <div class="bg-white p-6 rounded-lg shadow-md mb-6">
            <h2 class="text-xl font-semibold mb-4">Field Summary</h2>
            
            <div class="mb-4">
                <label for="fieldFilter" class="block text-sm font-medium text-gray-700 mb-1">Filter by Field:</label>
                <select id="fieldFilter" class="w-full md:w-1/2 p-2 border border-gray-300 rounded-md">
                    <option value="all">All Fields</option>
                    <% fieldSummaries.forEach(field => { %>
                        <option value="<%= field.fieldName %>"><%= field.fieldName %></option>
                    <% }); %>
                </select>
            </div>
            
            <% fieldSummaries.forEach(field => { %>
                <div class="field-section mb-8" data-field="<%= field.fieldName %>">
                    <h3 class="text-lg font-semibold mb-3 bg-gray-200 p-2 rounded">
                        <%= field.fieldName %>
                    </h3>
                    
                    <% Object.entries(field.yearGroups).forEach(([year, yearData]) => { %>
                        <div class="mb-6">
                            <h4 class="text-md font-medium mb-2">
                                <%= year %> - <%= yearData.gameType %>
                            </h4>
                            
                            <table class="game-table">
                                <thead>
                                    <tr>
                                        <th>Time</th>
                                        <th>Team 1</th>
                                        <th>Team 2</th>
                                        <th>Duration</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <% yearData.games.forEach(game => { %>
                                        <tr>
                                            <td><%= game.time %></td>
                                            <td class="<%= !game.team1 ? 'empty-team' : '' %>">
                                                <%= game.team1 || 'No team' %>
                                            </td>
                                            <td class="<%= !game.team2 ? 'empty-team' : '' %>">
                                                <%= game.team2 || 'No team' %>
                                            </td>
                                            <td><%= game.gameDuration %></td>
                                        </tr>
                                    <% }); %>
                                </tbody>
                            </table>
                        </div>
                    <% }); %>
                </div>
            <% }); %>
        </div>
    </div>
    
    <script>
        // Simple client-side filtering
        document.getElementById('fieldFilter').addEventListener('change', function() {
            const selectedField = this.value;
            const fieldSections = document.querySelectorAll('.field-section');
            
            fieldSections.forEach(section => {
                if (selectedField === 'all' || section.dataset.field === selectedField) {
                    section.style.display = 'block';
                } else {
                    section.style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>
